
# Mechanism: Address Translation

## Simulation

### Questions

1. Run with seeds 1, 2, and 3, and compute whether each virtual address generated by the process is in or out of bounds. If in bounds, compute the translation.

```./relocate.py -s 1```

```
Base: 0x0000363c (decimal 13884)
Limit: 260
VA 0: 782 - Segfault
VA 1: 261 - (14125)
VA 2: 507 - Segfault
VA 3: 460 - Segfault
VA 4: 667 - Segfault
```

```./relocate.py -s 2```

```
Base: 0x00003ca9 (decimal 15529)
Limit: 500
VA 0: 57 - (15586)
VA 1: 86 - (15615)
VA 2: 855 - Segfault
VA 3: 753 - Segfault
VA 4: 685 - Segfault
```

```./relocate.py -s 3```

```
Base: 0x000022d4c (decimal 8916)
Limit: 316
VA 0: 378 - Segfault
VA 1: 618 - Segfault
VA 2: 640 - Segfault
VA 3: 67  - 8983
VA 4: 13  - 8929
```

2. Run with these flags: -s 0 -n 10. What value do you have to set -l (the bounds register) to in order to ensure that all the generated virtual addresses are within bounds?

```./relocate -s 0 -n 10```

```
Base: 0x00003082 (decimal 12418)
Limit: 472
VA 0:  430
VA 1:  265
VA 2:  523
VA 3:  414
VA 4:  802
VA 5:  310
VA 6:  488
VA 7:  597
VA 8:  929
VA 9:  516
```

Bounds register must be set to 930

3. Run with these flags: -s 1 -n 10 -l 100. What is the maximum value that base can be set to, such that the address space still fits into physical memory in its entirety?

```./relocate -s 1 -n 10 -l 100```

```
ARG seed 0
ARG address space size 1k
ARG phys mem size 16k
```

Needs 100 for memory space, so 16K - 100. (16 * 1024) - 100 = 16284

4. Run some of the same problems above, but with larger address spaces (-a) and physical memories (-p).

5.  What fraction of randomly-generated virtual addresses are valid, as a function of the value of the bounds register? Make a graph from running with different random seeds, with limit values ranging from 0 up to the maximum size of the address space.

Using 10 addresses, with random seeds.

| Bound | Fraction Valid |
|:-:|:-:|
|0|0|
|25|0|
|100|0|
|200|4/10|
|500|3/10|
|1000|10/10|
|2000|10/10|
|4000|10/10|
